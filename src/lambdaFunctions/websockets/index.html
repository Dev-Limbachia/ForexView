<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Forex Data Retrieval</title>
</head>
<body>
    <h1>Forex Data Retrieval</h1>

    <div>
        <button onclick="getData('EUR-USD')">Get EUR/USD Data</button>
        <button onclick="getData('USD-JPY')">Get USD/JPY Data</button>
        <button onclick="getData('GBP-USD')">Get GBP/USD Data</button>
        <button onclick="getData('AUD-USD')">Get AUD/USD Data</button>
        <button onclick="getData('USD-CHF')">Get USD/CHF Data</button>
    </div>

    <h2>Forex Data</h2>
    <ul id="forexList"></ul>

    <script>
        const socket = new WebSocket('wss://2xcsvlahya.execute-api.us-east-1.amazonaws.com/production/');

        function getData(currencyPair) {
            console.log(`Fetching data for ${currencyPair}...`);
            const message = {
                action: 'getData',
                queryStringParameters: {
                    currency_pair: currencyPair
                }
            };
            if (socket.readyState === WebSocket.OPEN) {
                socket.send(JSON.stringify(message));
                console.log('Message sent:', message);
            } else {
                console.error('WebSocket connection is not open.');
            }
        }

        function updateForexData(data) {
            const forexList = document.getElementById('forexList');
            forexList.innerHTML = ''; // Clear previous data

            data.forEach(item => {
                const { currency_pair, open, high, low, close } = item;
                const listItem = document.createElement('li');
                listItem.textContent = `Currency Pair: ${currency_pair}, Open: ${open}, High: ${high}, Low: ${low}, Close: ${close}`;
                forexList.appendChild(listItem);
            });

            console.log('Updated Forex Data:', data);
        }

        socket.onmessage = function(event) {
            const data = JSON.parse(event.data);
            console.log('Received data from server:', data);
            updateForexData(data);
        };

        socket.onopen = function() {
            console.log('WebSocket connection established.');
        };

        socket.onerror = function(error) {
            console.error('WebSocket error:', error);
        };
    </script>
</body>
</html>
